<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Using ACE potentials in Molly · ACE1pack.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://ACEsuit.github.io/ACE1pack.jl/tutorials/molly/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ACE1pack.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../gettingstarted/installation/">Installation Instructions</a></li><li><a class="tocitem" href="../../gettingstarted/pkg/">Using the Julia Package Manager</a></li><li><a class="tocitem" href="../../gettingstarted/aceintro/">Introduction to ACE Models</a></li><li><a class="tocitem" href="../../gettingstarted/parallel-fitting/">Parallel Fitting</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../">Tutorials Overview</a></li><li><a class="tocitem" href="../../literate_tutorials/first_example_model/">First example</a></li><li><a class="tocitem" href="../../literate_tutorials/TiAl_model/">The <code>acemodel</code> interface from Julia (TiAl potential)</a></li><li><a class="tocitem" href="../../literate_tutorials/TiAl_basis/">The <code>ace_basis</code> interface from Julia (TiAl)</a></li><li><a class="tocitem" href="../../literate_tutorials/descriptor/">ACE Descriptors</a></li><li><a class="tocitem" href="../../literate_tutorials/committee/">Committee Potentials</a></li><li><a class="tocitem" href="../lammps/">ACE1pack potentials in LAMMPS</a></li><li><a class="tocitem" href="../python_ase/">python-<code>ase</code></a></li><li class="is-active"><a class="tocitem" href>Using ACE potentials in Molly</a><ul class="internal"><li><a class="tocitem" href="#Things-to-know-about-Molly"><span>Things to know about Molly</span></a></li><li><a class="tocitem" href="#System-setup"><span>System setup</span></a></li><li><a class="tocitem" href="#Set-up-simulation"><span>Set up simulation</span></a></li></ul></li></ul></li><li><span class="tocitem">Command line</span><ul><li><a class="tocitem" href="../command_line_old/">OLD (!) Command line interface</a></li></ul></li><li><span class="tocitem">ACE1pack Internals</span><ul><li><a class="tocitem" href="../../ACE1pack/ace1pack_overview/">Overview</a></li><li><a class="tocitem" href="../../ACE1pack/fit/">Fitting ACE</a></li><li><a class="tocitem" href="../../ACE1pack/helpers/">Helper Functions</a></li><li><a class="tocitem" href="../../ACE1pack/data/">Handling Data</a></li><li><a class="tocitem" href="../../ACE1pack/basis/">Constructing Basis</a></li><li><a class="tocitem" href="../../ACE1pack/solver/">Solvers</a></li><li><a class="tocitem" href="../../ACE1pack/all_exported/">All ACE1pack functions</a></li></ul></li><li><span class="tocitem">ACEfit Internals</span><ul><li><a class="tocitem" href="../../ACEfit/Fitting/">ACE1 and ACEfit</a></li><li><a class="tocitem" href="../../ACEfit/Solvers/">Least squares solvers</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Using ACE potentials in Molly</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Using ACE potentials in Molly</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ACEsuit/ACE1pack.jl/blob/main/docs/src/tutorials/molly.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ACE-potentials-in-Molly"><a class="docs-heading-anchor" href="#Using-ACE-potentials-in-Molly">Using ACE potentials in Molly</a><a id="Using-ACE-potentials-in-Molly-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ACE-potentials-in-Molly" title="Permalink"></a></h1><p><a href="https://github.com/JuliaMolSim/Molly.jl">Molly</a> is pure Julia MD program that is in development. ACE support for Molly is currently in <a href="https://github.com/ACEsuit/ACEmd.jl">ACEmd</a> package, which is exported by ACE1pack. </p><h2 id="Things-to-know-about-Molly"><a class="docs-heading-anchor" href="#Things-to-know-about-Molly">Things to know about Molly</a><a id="Things-to-know-about-Molly-1"></a><a class="docs-heading-anchor-permalink" href="#Things-to-know-about-Molly" title="Permalink"></a></h2><p>Molly expects units to be defined. Our fitting procedure does not define units, so in order to use Molly, units need to be defined. This is done by wrapping potentials to a structure that holds units in addition to the potential. The units used are defined in <a href="https://github.com/PainterQubits/Unitful.jl">Unitful</a>, which is exported by default.</p><p>To wrap units for a potential you can use <code>load_ace_model</code> function, which can take in a potential you have just fitted as an input. You can also load <code>json</code> or <code>yace</code> potential files.</p><pre><code class="language-julia hljs">pot_with_units = load_ace_model( potential_with_no_units )

# Load potential files
pot_with_units = load_ace_model( &quot;path to potential file&quot; )</code></pre><p>The default units are eV for energy and Å for length. You can change these with</p><pre><code class="language-julia hljs">load_ace_model( &quot;path to potential file&quot;;
                energy_unit = u&quot;hartree&quot;,
                length_unit = u&quot;bohr&quot;,
                cutoff_unit = u&quot;pm&quot; )</code></pre><h2 id="System-setup"><a class="docs-heading-anchor" href="#System-setup">System setup</a><a id="System-setup-1"></a><a class="docs-heading-anchor-permalink" href="#System-setup" title="Permalink"></a></h2><p>To start Molly you need to prepare Molly system. With ACE there are still some ACE specific complications with this. But please refer for Molly documentation </p><pre><code class="language-julia hljs">using Molly
using ACE1pack # or ACEmd
using ExtXYZ

# Load initial structure
data = FastSystem(ExtXYZ.Atoms(read_frame(&quot;initial structure in xyz file&quot;)))
# or use whatever AtomsBase structure

# Load ACE potential
pot = load_ace_model(&quot;some ace potential&quot;)

# Prepare data to Molly compatible format
atoms = [Molly.Atom( index=i, mass=AtomsBase.atomic_mass(data, i) ) for i in 1:length(data) ]

# Create boundary conditions
boundary = begin
    box = bounding_box(data)
    CubicBoundary(box[1][1], box[2][2], box[3][3])
end

# Prepare atomic number data. This is an ACE specific customization for older Molly versions.
atom_data = [ (; :Z=&gt;z,:element=&gt;s)  for (z,s) in zip(AtomsBase.atomic_number(data), AtomsBase.atomic_symbol(data))  ]

# Set up temperature and velocities
temp = 298.0u&quot;K&quot;
velocities = [random_velocity(m, temp) for m in atomic_mass(data)]

# Set up Molly system it self
sys = System(
           atoms=atoms,
           atoms_data = atom_data,
           coords=position(data),
           velocities=velocities,
           general_inters = (pot,),
           boundary=boundary,
           loggers=(temp=TemperatureLogger(100),), # add more loggers here
           energy_units=u&quot;eV&quot;,  # Molly simulation units
           force_units=u&quot;eV/Å&quot;,
       )</code></pre><h2 id="Set-up-simulation"><a class="docs-heading-anchor" href="#Set-up-simulation">Set up simulation</a><a id="Set-up-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-simulation" title="Permalink"></a></h2><p>To setup Molly simulation you need to create simulation object</p><pre><code class="language-julia hljs"># Set up simulator
simulator = VelocityVerlet(
    dt=1.0u&quot;fs&quot;,
    coupling=AndersenThermostat(temp, 1.0u&quot;ps&quot;),
)</code></pre><p>After this you can run the simulation by</p><pre><code class="language-julia hljs"># Perform MD for 1000 steps
simulate!(sys, simulator, 1000)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../python_ase/">« python-<code>ase</code></a><a class="docs-footer-nextpage" href="../command_line_old/">OLD (!) Command line interface »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 18 August 2023 00:43">Friday 18 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
